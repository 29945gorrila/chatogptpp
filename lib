local Cohoes = {}
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")

-- Theme
local Theme = {
    Background = Color3.fromRGB(10, 10, 10),
    Secondary = Color3.fromRGB(18, 18, 18),
    Tertiary = Color3.fromRGB(30, 30, 30),
    Accent = Color3.fromRGB(155, 150, 219),
    AccentDark = Color3.fromRGB(200, 200, 200),
    Text = Color3.fromRGB(255, 255, 255),
    TextDark = Color3.fromRGB(120, 120, 120),
    Success = Color3.fromRGB(100, 255, 150),
    Warning = Color3.fromRGB(255, 200, 100),
    Error = Color3.fromRGB(255, 100, 100),
    Border = Color3.fromRGB(60, 60, 60),
    Glow = Color3.fromRGB(255, 255, 255),
    Shadow = Color3.fromRGB(0, 0, 0)
}

Cohoes.Theme = Theme
Cohoes.Flags = {}
Cohoes.ConfigFlags = {}

-- Utility for theme updating
local ThemeObjects = {
    accent = {
        BackgroundColor3 = {},
        TextColor3 = {},
        ImageColor3 = {},
        ScrollBarImageColor3 = {}
    }
}

function Cohoes:ApplyTheme(instance, property)
    table.insert(ThemeObjects.accent[property], instance)
end

function Cohoes:UpdateTheme(color)
    for property, objects in pairs(ThemeObjects.accent) do
        for _, obj in pairs(objects) do
            if obj[property] == Theme.Accent then
                obj[property] = color
            end
        end
    end
    Theme.Accent = color
end

-- Helper function to add glow effect
local function AddGlow(element, color, size, transparency)
    local glow = Instance.new("ImageLabel")
    glow.Name = "Glow"
    glow.BackgroundTransparency = 1
    glow.Size = UDim2.new(1, size or 20, 1, size or 20)
    glow.Position = UDim2.new(0.5, 0, 0.5, 0)
    glow.AnchorPoint = Vector2.new(0.5, 0.5)
    glow.Image = "rbxassetid://5028857084"
    glow.ImageColor3 = color or Theme.Glow
    glow.ImageTransparency = transparency or 0.7
    glow.ZIndex = element.ZIndex - 1
    glow.Parent = element
    return glow
end

-- Helper function to add drop shadow (enhanced version)
local function AddShadow(element, transparency)
    local shadow = Instance.new("ImageLabel")
    shadow.Name = "Shadow"
    shadow.BackgroundTransparency = 1
    shadow.Size = UDim2.new(1, 75, 1, 75)
    shadow.Position = UDim2.new(0.5, 0, 0.5, 0)
    shadow.AnchorPoint = Vector2.new(0.5, 0.5)
    shadow.Image = "rbxassetid://112971167999062"
    shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
    shadow.ImageTransparency = transparency or 0.5
    shadow.ZIndex = element.ZIndex - 100
    shadow.ScaleType = Enum.ScaleType.Slice
    shadow.SliceCenter = Rect.new(Vector2.new(112, 112), Vector2.new(147, 147))
    shadow.SliceScale = 0.75
    shadow.Parent = element
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 5)
    corner.Parent = shadow
    
    return shadow
end

-- Smooth tween helper
function Cohoes:tween(obj, properties, easingStyle, time)
    local tween = TweenService:Create(
        obj,
        TweenInfo.new(
            time or 0.25,
            easingStyle or Enum.EasingStyle.Quint,
            Enum.EasingDirection.InOut,
            0,
            false,
            0
        ),
        properties
    )
    tween:Play()
    return tween
end

-- Screen GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "CohoesUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

local function ProtectGui()
    local success = pcall(function()
        if syn and syn.protect_gui then
            syn.protect_gui(ScreenGui)
            ScreenGui.Parent = game.CoreGui
        elseif gethui then
            ScreenGui.Parent = gethui()
        else
            ScreenGui.Parent = game.CoreGui
        end
    end)
    
    if not success then
        pcall(function()
            ScreenGui.Parent = Players.LocalPlayer:WaitForChild("PlayerGui")
        end)
    end
end

ProtectGui()

-- Dropdown overlay container
local OverlayContainer = Instance.new("Frame")
OverlayContainer.Name = "OverlayContainer"
OverlayContainer.Size = UDim2.new(1, 0, 1, 0)
OverlayContainer.BackgroundTransparency = 1
OverlayContainer.ZIndex = 100
OverlayContainer.Parent = ScreenGui

-- Notification System
local NotifHolder = Instance.new("Frame")
NotifHolder.Name = "Notifications"
NotifHolder.Size = UDim2.new(0, 300, 1, -40)
NotifHolder.Position = UDim2.new(1, -310, 0, 20)
NotifHolder.BackgroundTransparency = 1
NotifHolder.ZIndex = 200
NotifHolder.Parent = ScreenGui

local NotifLayout = Instance.new("UIListLayout")
NotifLayout.SortOrder = Enum.SortOrder.LayoutOrder
NotifLayout.Padding = UDim.new(0, 6)
NotifLayout.VerticalAlignment = Enum.VerticalAlignment.Top
NotifLayout.Parent = NotifHolder

function Cohoes:Notify(options)
    local title = options.Title or "Notification"
    local message = options.Message or ""
    local duration = options.Duration or 3
    
    local notif = Instance.new("Frame")
    notif.Size = UDim2.new(1, 0, 0, 55)
    notif.BackgroundColor3 = Theme.Secondary
    notif.BorderSizePixel = 0
    notif.Position = UDim2.new(1, 20, 0, 0)
    notif.ZIndex = 201
    notif.Parent = NotifHolder
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 4)
    corner.Parent = notif
    
    local stroke = Instance.new("UIStroke")
    stroke.Color = Theme.Border
    stroke.Thickness = 1
    stroke.Parent = notif
    
    local glow = AddGlow(notif, Theme.Accent, 25, 0.5)
    
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1, -16, 0, 20)
    titleLabel.Position = UDim2.new(0, 8, 0, 6)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.Text = title
    titleLabel.TextColor3 = Theme.Text
    titleLabel.TextSize = 12
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.ZIndex = 202
    titleLabel.Parent = notif
    
    local msgLabel = Instance.new("TextLabel")
    msgLabel.Size = UDim2.new(1, -16, 0, 18)
    msgLabel.Position = UDim2.new(0, 8, 0, 26)
    msgLabel.BackgroundTransparency = 1
    msgLabel.Font = Enum.Font.Gotham
    msgLabel.Text = message
    msgLabel.TextColor3 = Theme.TextDark
    msgLabel.TextSize = 10
    msgLabel.TextXAlignment = Enum.TextXAlignment.Left
    msgLabel.TextTruncate = Enum.TextTruncate.AtEnd
    msgLabel.ZIndex = 202
    msgLabel.Parent = notif
    
    local progressBg = Instance.new("Frame")
    progressBg.Size = UDim2.new(1, 0, 0, 2)
    progressBg.Position = UDim2.new(0, 0, 1, -2)
    progressBg.BackgroundColor3 = Theme.Tertiary
    progressBg.BorderSizePixel = 0
    progressBg.ZIndex = 202
    progressBg.Parent = notif
    
    local progress = Instance.new("Frame")
    progress.Size = UDim2.new(1, 0, 1, 0)
    progress.BackgroundColor3 = Theme.Accent
    progress.BorderSizePixel = 0
    progress.ZIndex = 203
    progress.Parent = progressBg
    
    Cohoes:tween(notif, {Position = UDim2.new(0, 0, 0, 0)}, Enum.EasingStyle.Quart, 0.3)
    Cohoes:tween(progress, {Size = UDim2.new(0, 0, 1, 0)}, Enum.EasingStyle.Linear, duration)
    
    task.delay(duration, function()
        Cohoes:tween(notif, {Position = UDim2.new(1, 20, 0, 0)}, Enum.EasingStyle.Quart, 0.3)
        task.wait(0.35)
        notif:Destroy()
    end)
end

-- Window Creation
function Cohoes:CreateWindow(options)
    local Window = {}
    
    local title = options.Title or "skibi.cc"
    local subtitle = options.Subtitle or "premium"
    local size = options.Size or {700, 565}
    local toggleKey = options.ToggleKey or Enum.KeyCode.RightShift
    
    local Main = Instance.new("Frame")
    Main.Name = "MainWindow"
    Main.Size = UDim2.new(0, size[1], 0, size[2])
    Main.Position = UDim2.new(0.5, -size[1]/2, 0.5, -size[2]/2)
    Main.BackgroundColor3 = Theme.Background
    Main.BorderSizePixel = 0
    Main.Parent = ScreenGui
    
    local mainCorner = Instance.new("UICorner")
    mainCorner.CornerRadius = UDim.new(0, 10)
    mainCorner.Parent = Main
    
    local mainStroke = Instance.new("UIStroke")
    mainStroke.Color = Color3.fromRGB(23, 23, 29)
    mainStroke.Thickness = 1
    mainStroke.Parent = Main
    
    -- Enhanced shadow
    local mainShadow = AddShadow(Main, 0.2)
    
    -- Header
    local Header = Instance.new("Frame")
    Header.Name = "Header"
    Header.Size = UDim2.new(1, 0, 0, 32)
    Header.BackgroundColor3 = Theme.Secondary
    Header.BorderSizePixel = 0
    Header.Parent = Main
    
    local headerCorner = Instance.new("UICorner")
    headerCorner.CornerRadius = UDim.new(0, 10)
    headerCorner.Parent = Header
    
    local headerFix = Instance.new("Frame")
    headerFix.Size = UDim2.new(1, 0, 0, 10)
    headerFix.Position = UDim2.new(0, 0, 1, -10)
    headerFix.BackgroundColor3 = Theme.Secondary
    headerFix.BorderSizePixel = 0
    headerFix.Parent = Header
    
    -- Title with RichText styling
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1, -70, 1, 0)
    titleLabel.Position = UDim2.new(0, 12, 0, 0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.Text = string.format('<u>%s</u><font color="rgb(255, 255, 255)">%s</font>', title, subtitle)
    titleLabel.RichText = true
    titleLabel.TextColor3 = Theme.Accent
    titleLabel.TextSize = 16
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.Parent = Header
    Cohoes:ApplyTheme(titleLabel, "TextColor3")
    
    -- Close button
    local closeBtn = Instance.new("TextButton")
    closeBtn.Size = UDim2.new(0, 20, 0, 20)
    closeBtn.Position = UDim2.new(1, -28, 0.5, -10)
    closeBtn.BackgroundColor3 = Theme.Tertiary
    closeBtn.BorderSizePixel = 0
    closeBtn.Font = Enum.Font.GothamBold
    closeBtn.Text = "×"
    closeBtn.TextColor3 = Theme.TextDark
    closeBtn.TextSize = 14
    closeBtn.Parent = Header
    
    local closeBtnCorner = Instance.new("UICorner")
    closeBtnCorner.CornerRadius = UDim.new(0, 4)
    closeBtnCorner.Parent = closeBtn
    
    local closeBtnGlow = AddGlow(closeBtn, Theme.Error, 15, 1)
    
    closeBtn.MouseEnter:Connect(function()
        Cohoes:tween(closeBtn, {BackgroundColor3 = Theme.Error}, Enum.EasingStyle.Quart, 0.15)
        Cohoes:tween(closeBtnGlow, {ImageTransparency = 0.4}, Enum.EasingStyle.Quart, 0.15)
    end)
    closeBtn.MouseLeave:Connect(function()
        Cohoes:tween(closeBtn, {BackgroundColor3 = Theme.Tertiary}, Enum.EasingStyle.Quart, 0.15)
        Cohoes:tween(closeBtnGlow, {ImageTransparency = 1}, Enum.EasingStyle.Quart, 0.15)
    end)
    closeBtn.MouseButton1Click:Connect(function()
        Main.Visible = false
    end)
    
    -- Minimize button
    local minBtn = Instance.new("TextButton")
    minBtn.Size = UDim2.new(0, 20, 0, 20)
    minBtn.Position = UDim2.new(1, -52, 0.5, -10)
    minBtn.BackgroundColor3 = Theme.Tertiary
    minBtn.BorderSizePixel = 0
    minBtn.Font = Enum.Font.GothamBold
    minBtn.Text = "−"
    minBtn.TextColor3 = Theme.TextDark
    minBtn.TextSize = 14
    minBtn.Parent = Header
    
    local minBtnCorner = Instance.new("UICorner")
    minBtnCorner.CornerRadius = UDim.new(0, 4)
    minBtnCorner.Parent = minBtn
    
    local minBtnGlow = AddGlow(minBtn, Theme.Warning, 15, 1)
    
    minBtn.MouseEnter:Connect(function()
        Cohoes:tween(minBtn, {BackgroundColor3 = Theme.Warning}, Enum.EasingStyle.Quart, 0.15)
        Cohoes:tween(minBtnGlow, {ImageTransparency = 0.4}, Enum.EasingStyle.Quart, 0.15)
    end)
    minBtn.MouseLeave:Connect(function()
        Cohoes:tween(minBtn, {BackgroundColor3 = Theme.Tertiary}, Enum.EasingStyle.Quart, 0.15)
        Cohoes:tween(minBtnGlow, {ImageTransparency = 1}, Enum.EasingStyle.Quart, 0.15)
    end)
    
    -- Tab sidebar
    local TabSidebar = Instance.new("Frame")
    TabSidebar.Name = "TabSidebar"
    TabSidebar.Size = UDim2.new(0, 196, 1, -40)
    TabSidebar.Position = UDim2.new(0, 4, 0, 36)
    TabSidebar.BackgroundColor3 = Theme.Secondary
    TabSidebar.BackgroundTransparency = 1
    TabSidebar.BorderSizePixel = 0
    TabSidebar.Parent = Main
    
    -- Sidebar divider
    local sidebarDivider = Instance.new("Frame")
    sidebarDivider.AnchorPoint = Vector2.new(1, 0)
    sidebarDivider.Position = UDim2.new(1, 0, 0, 0)
    sidebarDivider.Size = UDim2.new(0, 1, 1, 0)
    sidebarDivider.BackgroundColor3 = Color3.fromRGB(21, 21, 23)
    sidebarDivider.BorderSizePixel = 0
    sidebarDivider.Parent = TabSidebar
    
    local tabLayout = Instance.new("UIListLayout")
    tabLayout.SortOrder = Enum.SortOrder.LayoutOrder
    tabLayout.Padding = UDim.new(0, 5)
    tabLayout.Parent = TabSidebar
    
    local tabPadding = Instance.new("UIPadding")
    tabPadding.PaddingTop = UDim.new(0, 16)
    tabPadding.PaddingBottom = UDim.new(0, 36)
    tabPadding.PaddingLeft = UDim.new(0, 10)
    tabPadding.PaddingRight = UDim.new(0, 11)
    tabPadding.Parent = TabSidebar
    
    -- Content container
    local ContentContainer = Instance.new("Frame")
    ContentContainer.Name = "ContentContainer"
    ContentContainer.Size = UDim2.new(1, -216, 1, -101)
    ContentContainer.Position = UDim2.new(0, 196, 0, 56)
    ContentContainer.BackgroundTransparency = 1
    ContentContainer.ClipsDescendants = true
    ContentContainer.Parent = Main
    
    -- Global fade for transitions
    local GlobalFade = Instance.new("Frame")
    GlobalFade.Name = "GlobalFade"
    GlobalFade.Position = UDim2.new(0, 196, 0, 56)
    GlobalFade.Size = UDim2.new(1, -196, 1, -81)
    GlobalFade.BackgroundColor3 = Theme.Background
    GlobalFade.BackgroundTransparency = 1
    GlobalFade.BorderSizePixel = 0
    GlobalFade.ZIndex = 2
    GlobalFade.Parent = Main
    
    -- Bottom info bar
    local InfoBar = Instance.new("Frame")
    InfoBar.AnchorPoint = Vector2.new(0, 1)
    InfoBar.Position = UDim2.new(0, 0, 1, 0)
    InfoBar.Size = UDim2.new(1, 0, 0, 25)
    InfoBar.BackgroundColor3 = Color3.fromRGB(23, 23, 25)
    InfoBar.BorderSizePixel = 0
    InfoBar.Parent = Main
    
    local infoCorner = Instance.new("UICorner")
    infoCorner.CornerRadius = UDim.new(0, 10)
    infoCorner.Parent = InfoBar
    
    local infoFix = Instance.new("Frame")
    infoFix.Size = UDim2.new(1, 0, 0, 6)
    infoFix.BackgroundColor3 = Color3.fromRGB(23, 23, 25)
    infoFix.BorderSizePixel = 0
    infoFix.Parent = InfoBar
    
    local gameInfo = Instance.new("TextLabel")
    gameInfo.Size = UDim2.new(1, 0, 0, 0)
    gameInfo.Position = UDim2.new(0, 10, 0.5, -1)
    gameInfo.AnchorPoint = Vector2.new(0, 0.5)
    gameInfo.BackgroundTransparency = 1
    gameInfo.Font = Enum.Font.GothamBold
    gameInfo.Text = options.GameInfo or "skibi.cc for " .. game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId).Name
    gameInfo.TextColor3 = Color3.fromRGB(72, 72, 73)
    gameInfo.TextSize = 14
    gameInfo.TextXAlignment = Enum.TextXAlignment.Left
    gameInfo.AutomaticSize = Enum.AutomaticSize.XY
    gameInfo.Parent = InfoBar
    
    local userInfo = Instance.new("TextLabel")
    userInfo.Size = UDim2.new(1, 0, 0, 0)
    userInfo.Position = UDim2.new(0, -10, 0.5, -1)
    userInfo.AnchorPoint = Vector2.new(0, 0.5)
    userInfo.BackgroundTransparency = 1
    userInfo.Font = Enum.Font.GothamBold
    userInfo.Text = '<font color="rgb(72, 72, 73)">User: </font>' .. Players.LocalPlayer.Name
    userInfo.RichText = true
    userInfo.TextColor3 = Theme.Accent
    userInfo.TextSize = 14
    userInfo.TextXAlignment = Enum.TextXAlignment.Right
    userInfo.AutomaticSize = Enum.AutomaticSize.XY
    userInfo.Parent = InfoBar
    Cohoes:ApplyTheme(userInfo, "TextColor3")
    
    -- Dragging
    local dragging, dragStart, startPos = false, nil, nil
    
    Header.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = Main.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            Main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
    
    -- Toggle key
    UserInputService.InputBegan:Connect(function(input, processed)
        if processed then return end
        if input.KeyCode == toggleKey then
            Main.Visible = not Main.Visible
        end
    end)
    
    -- Minimize
    local minimized = false
    minBtn.MouseButton1Click:Connect(function()
        minimized = not minimized
        if minimized then
            Cohoes:tween(Main, {Size = UDim2.new(0, size[1], 0, 32)}, Enum.EasingStyle.Quart, 0.3)
            ContentContainer.Visible = false
            TabSidebar.Visible = false
            InfoBar.Visible = false
        else
            Cohoes:tween(Main, {Size = UDim2.new(0, size[1], 0, size[2])}, Enum.EasingStyle.Quart, 0.3)
            task.wait(0.15)
            ContentContainer.Visible = true
            TabSidebar.Visible = true
            InfoBar.Visible = true
        end
    end)
    
    Window.Main = Main
    Window.TabSidebar = TabSidebar
    Window.ContentContainer = ContentContainer
    Window.GlobalFade = GlobalFade
    Window.Tabs = {}
    Window.CurrentTab = nil
    Window.TabCount = 0
    
    function Window:CreateTab(name, icon)
        local Tab = {}
        Window.TabCount = Window.TabCount + 1
        
        local tabBtn = Instance.new("TextButton")
        tabBtn.Name = name
        tabBtn.Size = UDim2.new(1, 0, 0, 35)
        tabBtn.BackgroundColor3 = Theme.Tertiary
        tabBtn.BackgroundTransparency = 1
        tabBtn.BorderSizePixel = 0
        tabBtn.Font = Enum.Font.GothamBold
        tabBtn.Text = ""
        tabBtn.AutoButtonColor = false
        tabBtn.TextColor3 = Theme.TextDark
        tabBtn.TextSize = 16
        tabBtn.LayoutOrder = Window.TabCount
        tabBtn.Parent = TabSidebar
        
        local tabBtnCorner = Instance.new("UICorner")
        tabBtnCorner.CornerRadius = UDim.new(0, 7)
        tabBtnCorner.Parent = tabBtn
        
        local tabStroke = Instance.new("UIStroke")
        tabStroke.Color = Color3.fromRGB(23, 23, 29)
        tabStroke.Enabled = false
        tabStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
        tabStroke.Parent = tabBtn
        
        -- Icon
        local tabIcon = Instance.new("ImageLabel")
        tabIcon.AnchorPoint = Vector2.new(0, 0.5)
        tabIcon.Position = UDim2.new(0, 10, 0.5, 0)
        tabIcon.Size = UDim2.new(0, 22, 0, 22)
        tabIcon.BackgroundTransparency = 1
        tabIcon.Image = icon or "rbxassetid://6034767608"
        tabIcon.ImageColor3 = Color3.fromRGB(72, 72, 73)
        tabIcon.Parent = tabBtn
        Cohoes:ApplyTheme(tabIcon, "ImageColor3")
        
        -- Text
        local tabText = Instance.new("TextLabel")
        tabText.Position = UDim2.new(0, 40, 0, 0)
        tabText.Size = UDim2.new(0, 0, 1, 0)
        tabText.BackgroundTransparency = 1
        tabText.Font = Enum.Font.GothamBold
        tabText.Text = name
        tabText.TextColor3 = Color3.fromRGB(72, 72, 73)
        tabText.TextSize = 16
        tabText.TextXAlignment = Enum.TextXAlignment.Left
        tabText.AutomaticSize = Enum.AutomaticSize.X
        tabText.Parent = tabBtn
        
        local textPadding = Instance.new("UIPadding")
        textPadding.PaddingLeft = UDim.new(0, 5)
        textPadding.PaddingRight = UDim.new(0, 5)
        textPadding.Parent = tabText
        
        local page = Instance.new("ScrollingFrame")
        page.Name = name .. "Page"
        page.Size = UDim2.new(1, 0, 1, 0)
        page.BackgroundTransparency = 1
        page.BorderSizePixel = 0
        page.ScrollBarThickness = 3
        page.ScrollBarImageColor3 = Theme.TextDark
        page.CanvasSize = UDim2.new(0, 0, 0, 0)
        page.Visible = false
        page.Parent = ContentContainer
        
        local pageLayout = Instance.new("UIListLayout")
        pageLayout.SortOrder = Enum.SortOrder.LayoutOrder
        pageLayout.Padding = UDim.new(0, 6)
        pageLayout.Parent = page
        
        local function updateCanvasSize()
            task.wait(0.1)
            local contentSize = pageLayout.AbsoluteContentSize.Y
            page.CanvasSize = UDim2.new(0, 0, 0, contentSize + 10)
        end
        
        pageLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(updateCanvasSize)
        
        Window.Tabs[name] = {
            btn = tabBtn,
            icon = tabIcon,
            text = tabText,
            page = page,
            layout = pageLayout,
            updateCanvas = updateCanvasSize
        }
        
        Tab.page = page
        Tab.layout = pageLayout
        
        tabBtn.MouseButton1Click:Connect(function()
            if Window.CurrentTab and Window.Tabs[Window.CurrentTab] then
                local oldTab = Window.Tabs[Window.CurrentTab]
                
                -- Fade animation
                GlobalFade.BackgroundTransparency = 0
                Cohoes:tween(GlobalFade, {BackgroundTransparency = 1}, Enum.EasingStyle.Quad, 0.4)
                
                Cohoes:tween(oldTab.btn, {BackgroundTransparency = 1}, Enum.EasingStyle.Quart, 0.2)
                Cohoes:tween(oldTab.icon, {ImageColor3 = Color3.fromRGB(72, 72, 73)}, Enum.EasingStyle.Quart, 0.2)
                Cohoes:tween(oldTab.text, {TextColor3 = Color3.fromRGB(72, 72, 73)}, Enum.EasingStyle.Quart, 0.2)
                oldTab.page.Visible = false
            end
            
            Window.CurrentTab = name
            Cohoes:tween(tabBtn, {BackgroundTransparency = 0}, Enum.EasingStyle.Quart, 0.2)
            Cohoes:tween(tabIcon, {ImageColor3 = Theme.Accent}, Enum.EasingStyle.Quart, 0.2)
            Cohoes:tween(tabText, {TextColor3 = Color3.fromRGB(255, 255, 255)}, Enum.EasingStyle.Quart, 0.2)
            page.Visible = true
            updateCanvasSize()
        end)
        
        tabBtn.MouseEnter:Connect(function()
            if Window.CurrentTab ~= name then
                Cohoes:tween(tabBtn, {BackgroundTransparency = 0.5}, Enum.EasingStyle.Quart, 0.15)
            end
        end)
        
        tabBtn.MouseLeave:Connect(function()
            if Window.CurrentTab ~= name then
                Cohoes:tween(tabBtn, {BackgroundTransparency = 1}, Enum.EasingStyle.Quart, 0.15)
            end
        end)
        
        if Window.TabCount == 1 then
            task.wait(0.05)
            tabBtn.BackgroundTransparency = 0
            tabIcon.ImageColor3 = Theme.Accent
            tabText.TextColor3 = Color3.fromRGB(255, 255, 255)
            page.Visible = true
            Window.CurrentTab = name
            updateCanvasSize()
        end
        
        -- Continue with sections and elements here (keeping your existing implementations)
        -- I'll add a basic section creator as example
        
        function Tab:CreateSection(sectionName)
            local SectionOrder = 0
            
            local section = Instance.new("Frame")
            section.Name = sectionName
            section.Size = UDim2.new(1, 0, 0, 0)
            section.AutomaticSize = Enum.AutomaticSize.Y
            section.BackgroundColor3 = Theme.Secondary
            section.BorderSizePixel = 0
            section.Parent = page
            
            local sCorner = Instance.new("UICorner")
            sCorner.CornerRadius = UDim.new(0, 4)
            sCorner.Parent = section
            
            AddGlow(section, Theme.Accent, 10, 0.9)
            
            local sPadding = Instance.new("UIPadding")
            sPadding.PaddingLeft = UDim.new(0, 10)
            sPadding.PaddingRight = UDim.new(0, 10)
            sPadding.PaddingTop = UDim.new(0, 8)
            sPadding.PaddingBottom = UDim.new(0, 8)
            sPadding.Parent = section
            
            local sLayout = Instance.new("UIListLayout")
            sLayout.SortOrder = Enum.SortOrder.LayoutOrder
            sLayout.Padding = UDim.new(0, 6)
            sLayout.Parent = section
            
            local sLabel = Instance.new("TextLabel")
            sLabel.Size = UDim2.new(1, 0, 0, 16)
            sLabel.BackgroundTransparency = 1
            sLabel.Font = Enum.Font.GothamBold
            sLabel.Text = string.upper(sectionName)
            sLabel.TextColor3 = Theme.TextDark
            sLabel.TextSize = 10
            sLabel.TextXAlignment = Enum.TextXAlignment.Left
            sLabel.LayoutOrder = 0
            sLabel.Parent = section
            
            sLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
                task.wait(0.05)
                updateCanvasSize()
            end)
            
            return section, sLayout
        end
        
        return Tab
    end
    
    function Window:Destroy()
        Main:Destroy()
    end
    
    function Window:Toggle(visible)
        Main.Visible = visible
    end
    
    return Window
end

print("Enhanced Cohoes UI Library loaded successfully!")

return Cohoes
